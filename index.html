
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Kamranicus</title>
  <meta name="author" content="Kamran">

  
  <meta name="description" content="Kamranicus
Personal and development blog of Kamran Ayub about me Hi, my name is Kamran. I am a web developer and designer, residing in Minnesota. I &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://kamranicus.com">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://feeds.feedburner.com/Kamranicus" rel="alternate" title="Kamranicus" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1203259-13']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

  <body>
    <a href="/" class="home-icon">
      <img src="/images/home.png"/>
    </a>

    <div class="home-page">
  <div class="hero">
    <h1>Kamranicus</h1>
<p>Personal and development blog of Kamran Ayub</p>

  </div>

  <div class="home-field">
    <div class="home-landing her-row">
      <div class="container">
        <div class="row">
          <div id="about-me" class="col-md-offset-3 col-md-6">
  <h4>about me</h4>
  <p>Hi, my name is Kamran. I am a web developer and designer,  residing in Minnesota. I&#8217;ve been programming since 2001 and  I am familiar with many different languages, both web-based  and server-based. I love to tinker around and think of new  ways to solve problems.
</p>
  <div class="social-icon-list">
  	
    <a title="Twitter" href="https://twitter.com/kamranayub"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    
    
    <a title="GitHub" href="https://github.com/kamranayub"><img src="/images/glyphicons_social_21_github.png"/></a>
    
    
    
  </div>
</div>

        </div>
      </div>
    </div>

    <div class="article-list">
      <div class="container">
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2016/01/25/planet-wars-ai-competition-excaliburjs-csharp/">Planet Wars AI Competition With C# and Excalibur.js</a></h2>
  
  <p>
    <p><img src="https://zippy.gfycat.com/BraveBlushingImpala.gif" alt="Planet Wars" /></p>




<p>This past weekend <a href="http://twitter.com/erikonarheim">Erik</a> and I built out a <a href="https://github.com/eonarheim/planet-wars-competition">Planet Wars</a> server (written in C#) and an <a href="http://excaliburjs.com">Excalibur.js</a>-powered visualization (written in TypeScript). Planet Wars is an AI competition where you build an AI that competes against another player to control a solar system. A map consists of several planets that have different growth rates and an initial number of ships. You have to send out a &ldquo;fleet&rdquo; of ships to colonize other planets and the player who controls the most planets and has destroyed their opponent&rsquo;s ships wins the game.</p>




<p>At work we are hosting our 6th Code Camp and recently we started hosting an AI competition internally. You can find past competition agents for <a href="https://github.com/eonarheim/AntAICompetition">Ants</a> and <a href="https://github.com/eonarheim/BellTowerEscape">Elevators</a>, for example.</p>




<p>The <a href="https://github.com/eonarheim/planet-wars-competition/tree/master/PlanetWars/Scripts/game">visualization for Planet Wars</a> is fairly simple, made even simpler using the power of <a href="http://excaliburjs.com">Excalibur.js</a>, the engine we work on during our spare time. We basically just use an Excalibur timer to query the status of the game state and update the state of all the actors in the game. For moving the fleets, we just use the <a href="http://excaliburjs.com/docs/api/edge/classes/ex.actioncontext.html">Actor Action API</a>.</p>




<p>For the <a href="https://github.com/eonarheim/planet-wars-competition/tree/master/PlanetWars/Server">game server</a>, we are using a <a href="https://github.com/eonarheim/planet-wars-competition/blob/master/PlanetWars/Server/HighFrequencyTimer.cs">HighFrequencyTimer</a> to run a 30fps server and then clients just send commands via HTTP, so any kind of agent will work like Python, Perl, PowerShell, or whatever! Anything that speaks HTTP can be a client. The server runs in the context of a website so we can easily query the state using a singleton <code>GameManager</code>. This wouldn&rsquo;t work in a load-balanced environment but it doesn&rsquo;t matter since people develop agents locally and we run the simulations on one server at high-speed to produce the results. If you backed the server with a data store, you could replay games but right now there&rsquo;s only an in-memory implementation.</p>




<p>To keep the server and client models in-sync, we use <a href="http://frhagn.github.io/Typewriter/index.html">Typewriter for Visual Studio</a> which is <strong>amazing</strong> and super useful not just for syncing client/server but also generating web clients, interfaces, etc. from C# code. I plan to write a separate post on some Typewriter tips for Knockout.js and Web API.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2016-01-25T18:30:00+00:00" pubdate data-updated="true">Jan 25<span>th</span>, 2016</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/ai/'>AI</a>, <a class='category' href='/blog/categories/c-number/'>C#</a>, <a class='category' href='/blog/categories/excalibur-dot-js/'>Excalibur.js</a>, <a class='category' href='/blog/categories/games/'>Games</a>, <a class='category' href='/blog/categories/javascript/'>Javascript</a>, <a class='category' href='/blog/categories/typescript/'>Typescript</a>, <a class='category' href='/blog/categories/typewriter/'>Typewriter</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2016/01/05/year-in-review/">2015: A Year in Review</a></h2>
  
  <p>
    <p>2015 was a very eventful (and fulfilling) year for me and my wife. Let&rsquo;s break it down, shall we?</p>




<h2>Living abroad for 6 months</h2>




<p><img src="https://d262ilb51hltx0.cloudfront.net/max/2000/1*-h8wTj1iOSrHHtnGMxR60w.jpeg" alt="Bordeaux, France" /></p>




<p>By far the most impressive thing I did last year was to <a href="http://kamranicus.com/blog/2015/05/21/5-things-for-6-months-abroad/">take a 6 month sabbatical</a> and live abroad in France with my wife. Though I&rsquo;ve written about it previously, I left out the entire part where we chronicled our adventure in a series of publications on <a href="http://medium.com">Medium</a>. We kept it anonymous during the trip to avoid any potential issues but now that it&rsquo;s over, I will list the different publications so you can read back through what we did for 6 months (spoiler: we did <em>a lot</em>).</p>




<p>Just to be clear when you&rsquo;re reading, I am <strong>Vincent</strong> and my wife is <strong>Celeste.</strong></p>




<ul>
<li><a href="https://medium.com/visa-vis-a-guide">Visa-Vis: A Guide</a> &ndash; Prologue series of posts on steps to being able to live in France for 6 months</li>
<li><a href="https://medium.com/aix-squared">Aix Squared</a> &ndash; Dec 23, 2015-June 14, 2015 &ndash; General posts on food, cities, and living in France</li>
<li><a href="https://medium.com/aix-squared/rennes-france-d4957bf17d4e">Rennes</a>, <a href="https://medium.com/aix-squared/nantes-france-5c0aa9cf5ff">Nantes</a>, <a href="https://medium.com/aix-squared/bordeaux-france-c66f859826c9">Bordeaux</a> &ndash; April 24-30, 2015 &ndash; A tour of north/western France</li>
<li><a href="https://medium.com/aix-in-amsterdam">Aix in Amsterdam</a> &ndash; February 11-19, 2015</li>
<li><a href="https://medium.com/aix-in-marrakesh">Aix in Marrakesh</a> &ndash; March 10-16, 2015</li>
<li><a href="https://medium.com/aix-in-dublin">Aix in Dublin</a> &ndash; April 5-9, 2015</li>
<li><a href="https://medium.com/aix-in-oslo">Aix in Oslo</a> &ndash; April 9-13, 2015</li>
<li><a href="https://medium.com/aix-in-london">Aix in London</a> &ndash; May 12-16, 2015</li>
<li><a href="https://medium.com/aix-in-florence">Aix in Florence</a> &ndash; June 9-14, 2015</li>
</ul>




<p>It was an experience I&rsquo;ll never forget and one that probably won&rsquo;t be repeated anytime soon. My wife and I both felt it was the right time and that we&rsquo;d probably get little to no chance at doing something so crazy once we had kids and &ldquo;settled down.&rdquo; We still hope to continue traveling once a year or couple years, especially after an experience like that. One of my plans for 2016 is to compile all these posts into a book that we print and keep for us and our future children.</p>




<h2>New House</h2>




<p><img src="https://cloud.githubusercontent.com/assets/563819/12107000/cd7f12cc-b32a-11e5-852e-78b839331383.png" alt="Bay window" /></p>




<p>We weren&rsquo;t in a position to buy a house so soon after a 6 month sabbatical but we still thought it was best to move from apartment living to a real house, especially after living in a 400 sq ft space in France. We found a great place to rent in Minneapolis that&rsquo;s pretty close to both workplaces, friends, and family. We&rsquo;ve done a few things to it to make it more like home and we&rsquo;ve been really enjoying it so far and our landlord is superb. The photo above is our enhancement to the bay window. My brother-in-law built the spanning bench between the bookcases and I built the cushion. I removed the tall blinds that covered the window so we could open up the room and add extra seating. It turned out so good!</p>




<h2>New Dog</h2>




<p><img src="https://cloud.githubusercontent.com/assets/563819/12107029/1b61acac-b32b-11e5-9bee-3325f44374db.png" alt="Dogger" /></p>




<p>My wife has always wanted a dog ever since we moved into an apartment together&mdash;except our apartment complex never let us have dogs. We cat-sat (is that a word?) for 2 years for some friends and then they took her back down to Texas where they bought a house and she happily frolicks outside. In August (Dogust?) we went to the humane society and on pretty-much-a-whim took in a cute dog we named Rennes (after <a href="https://medium.com/aix-squared/rennes-france-d4957bf17d4e">one of our favorite French cities</a> we visited). She&rsquo;s a black lab and border collie mix. She&rsquo;s awesome even though she jumps the fence to chase squirrels (we&rsquo;re working on that). We love her a ton.</p>




<h2>Keep Track of My Games</h2>




<p><img src="http://41.media.tumblr.com/fe33ac3443fbfeab5b2e4da2c6fe170e/tumblr_inline_nyz1izCCVg1qlpzxk_500.png" alt="KTOMG" /></p>




<p>2015 marked the <a href="http://blog.keeptrackofmygames.com/post/124929587854/happy-4th-birthday-to-keep-track-of-my-games">4th year</a> that <a href="http://keeptrackofmygames.com">KTOMG</a> has been around since its humble beginnings and while I was abroad it gave me time to focus and finish a <a href="http://kamranicus.com/blog/2015/05/30/ktomg-update/">major rewrite of the codebase in May</a>. Since then I&rsquo;ve released <a href="http://blog.keeptrackofmygames.com/post/134750555276/updates-for-november-2015">public lists</a> and capping the year off with <a href="http://blog.keeptrackofmygames.com/post/135781123861/updates-for-december-2015">Steam syncing</a>, just to name a few features.</p>




<h2>Speaking</h2>




<iframe width="420" height="315" src="https://www.youtube.com/embed/kb7tvaBJeMs" frameborder="0" allowfullscreen></iframe>




<p>Even though I was abroad for 6 months, I still managed to give a talk this year at Twin Cities Code Camp 19: an update to my popular <a href="http://kamranicus.com/presentations/demystifying-typescript">Demystifying TypeScript</a> presentation. You can also find 2014&rsquo;s version <a href="https://www.youtube.com/watch?v=kb7tvaBJeMs">on YouTube</a>.</p>




<h2>Making Games</h2>




<p><img src="https://cloud.githubusercontent.com/assets/563819/12107063/7b1593c0-b32b-11e5-9148-0470e84acfb4.png" alt="Minotaur" /></p>




<p>In August, I participated in the <a href="http://ludumdare.com/compo/ludum-dare-33/">Ludum Dare 33</a> game jam where some friends and I created a minotaur hack-n-slash game, <a href="http://excaliburjs.com/ludum-33/">Crypt of the Minotaur</a> (<a href="https://github.com/excaliburjs/ludum-33">source</a>). I love participating in game jams and by extension, helping to contribute to the <a href="http://excaliburjs.com">Excalibur.js</a> game engine.</p>




<h2>Playing Games</h2>




<p>Somehow after all that I still managed to log hundreds of hours into my gaming habit. Since I added public lists to KTOMG, why don&rsquo;t you go take a look at my <a href="http://keeptrackofmygames.com/users/kamranicus/lists/11">Top 10 Played Games of 2015</a>? Yes, some of those came out in 2014 but I didn&rsquo;t play or finish them until this year. Being abroad, I managed to bring my laptop, 3DS, and PS4 so I played a lot of <a href="http://keeptrackofmygames.com/games/1931">Destiny</a>, finished the remastered <a href="http://keeptrackofmygames.com/games/394">Grim Fandango</a> and other PS4/3DS games. My laptop wasn&rsquo;t that great but I was able to still enjoy <a href="http://keeptrackofmygames.com/games/1267">Pillars of Eternity</a>, a throwback Baldur&rsquo;s Gate-style RPG. In November, I started playing <a href="http://keeptrackofmygames.com/games/145171">Fallout 4</a> and have since logged over 75 hours in it. It&rsquo;s definitely tough to juggle both hobbies: playing games and developing a site that helps manage those games. During time off, I usually try to mix my time between them to satisfy both needs and sticking to a monthly release cadence helps a lot to prioritize work.</p>




<h2>Work &amp; Friends</h2>




<p>My work has been going swimmingly, after my sabbatical I returned to work on a team with one of my best friends. Speaking of friends, I made more this year, fulfilling a goal I made at the start of 2015&mdash;not only abroad but also at home. Board game nights, Dungeon World sessions, and a Star Wars marathon are just some of the highlights of the fun stuff we&rsquo;ve done with our [awesome] circle of friends.</p>




<h2>Looking towards a new year</h2>




<p>Cheers to 2016, let&rsquo;s hope it&rsquo;s even bigger and better than 2015 and brings more happiness and joy to my life.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2016-01-05T01:30:00+00:00" pubdate data-updated="true">Jan 5<span>th</span>, 2016</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/accomplishments/'>Accomplishments</a>, <a class='category' href='/blog/categories/life/'>Life</a>, <a class='category' href='/blog/categories/year-in-review/'>Year in Review</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2015/12/11/kudu-deployment-flags-in-commit-messages/">Influencing Your Kudu Deployment Through Git Commit Messages</a></h2>
  
  <p>
    <p>If you&rsquo;re on Windows Azure and using continuous deployment through Git, you may not know you are using an open source platform called
<a href="https://github.com/projectkudu/kudu">Kudu</a> behind-the-scenes that performs your deployment. If this is the first time you&rsquo;ve heard of Kudu and you&rsquo;ve been
using Azure for awhile, it&rsquo;s time to <a href="https://github.com/projectkudu/kudu">get acquainted</a>. Kudu is amazing. It has a whole REST API that lets you manage
deployments, trigger builds, trigger webjobs, view processes, a command prompt, and a ton more.</p>




<p>You can get to your Kudu console by visiting</p>




<pre><code>https://&lt;yoursite&gt;.scm.azurewebsites.net
</code></pre>




<p>The <strong>.scm.</strong> part is the key, as that is where the Kudu site is hosted.</p>




<h2>Customizing Kudu deployments</h2>




<p>One of the other things it offers is a <a href="https://github.com/projectkudu/kudu/wiki/Custom-Deployment-Script">customized deployment script</a>. I&rsquo;ve customized mine because I have a test
project where I run automated tests during the build. This is useful since it&rsquo;ll fail the build if I make any changes
that break my tests and forces me to keep things up-to-date resulting in a higher quality codebase.</p>




<p>If you want to generate your own script, it&rsquo;s pretty easy. Just follow the steps <a href="https://github.com/projectkudu/kudu/wiki/Custom-Deployment-Script">outlined here</a>. For example, after
customizing my script here&rsquo;s what my section looks like to run my tests:</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:: 3. Build unit tests
</span><span class='line'>call :ExecuteCmd &ldquo;%MSBUILD_PATH%&rdquo; &ldquo;%DEPLOYMENT_SOURCE%\src\Tests\Tests.csproj&rdquo; /nologo /verbosity:m /t:Build /p:AutoParameterizationWebConfigConnectionStrings=false;Configuration=Release /p:SolutionDir=&ldquo;%DEPLOYMENT_SOURCE%.\&rdquo; %SCM_BUILD_ARGS%
</span><span class='line'>
</span><span class='line'>IF !ERRORLEVEL! NEQ 0 goto error</span></code></pre></td></tr></table></div></figure></p>

<p>All I really did was copy step 2 in the script that builds my web project and just change the path to my tests project.</p>




<p>Finally, I run the tests using the packaged Nunit test runner (checked into source control):</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>call :ExecuteCmd &ldquo;%DEPLOYMENT_SOURCE%\tools\nunit\nunit-console.exe&rdquo; &ldquo;%DEPLOYMENT_SOURCE%\src\Tests\bin\Release\Tests.dll&rdquo; /framework:v4.5.1
</span><span class='line'>IF !ERRORLEVEL! NEQ 0 goto error</span></code></pre></td></tr></table></div></figure></p>

<p>Simple!</p>




<h2>Now the fun part</h2>




<p>One thing you&rsquo;ll notice if you start running tests on your builds is that this starts to slow down your continuous deployment workflow.
For 90% of the time this is acceptable, after all, you can wait a few minutes to see your changes show up on the site. But sometimes,
especially for production hotfixes or trial-and-error config changes, that 3-5 minutes becomes unbearable.</p>




<p>In cases like this, I&rsquo;ve set up a little addition to my script that will read the git commit message and take action depending on what phrases it sees.</p>




<p>For example, let&rsquo;s say I commit a change that is just a config change and I know I don&rsquo;t need to run any tests or I really want the quick build.
This is what my commit message looks like:</p>




<pre><code>[notest] just changing App.config
</code></pre>




<p>That phrase <code>[notest]</code> is something my script looks for at build time and if it&rsquo;s present it will skip running tests!
You can use this same logic to do pretty much anything you want. Here&rsquo;s what it looks like after step 3 in my script:</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:: Above at top of file
</span><span class='line'>
</span><span class='line'>IF NOT DEFINED RUN_TESTS (
</span><span class='line'>   SET RUN_TESTS=1
</span><span class='line'>)
</span><span class='line'>
</span><span class='line'>:: 4. Run unit tests
</span><span class='line'>echo Latest commit ID is &ldquo;%SCM_COMMIT_ID%&rdquo;
</span><span class='line'>
</span><span class='line'>call git show -s &ldquo;%SCM_COMMIT_ID%&rdquo; &mdash;pretty=%%%%s &gt; commitmessage.txt
</span><span class='line'>SET /p COMMIT_MESSAGE=&lt;commitmessage.txt
</span><span class='line'>
</span><span class='line'>echo Latest commit message is &ldquo;%COMMIT_MESSAGE%&rdquo;
</span><span class='line'>
</span><span class='line'>IF NOT &ldquo;x%COMMIT_MESSAGE:[notest]=%&rdquo;==&ldquo;x%COMMIT_MESSAGE%&rdquo; (
</span><span class='line'>   SET RUN_TESTS=0
</span><span class='line'>)
</span><span class='line'>
</span><span class='line'>IF /I &ldquo;%RUN_TESTS%&rdquo; NEQ &ldquo;0&rdquo; (
</span><span class='line'>  echo Running unit tests
</span><span class='line'>  call :ExecuteCmd &ldquo;%DEPLOYMENT_SOURCE%\tools\nunit\nunit-console.exe&rdquo; &ldquo;%DEPLOYMENT_SOURCE%\src\Tests\bin\Release\Tests.dll&rdquo; /framework:v4.5.1
</span><span class='line'>  IF !ERRORLEVEL! NEQ 0 goto error
</span><span class='line'>) ELSE (
</span><span class='line'>  echo Not running unit tests because [notest] was present in commit message
</span><span class='line'>)</span></code></pre></td></tr></table></div></figure></p>

<p>Alright, there&rsquo;s definitely some batch file black magic incantations going on here! So let&rsquo;s break it down.</p>




<pre><code>echo Latest commit ID is "%SCM_COMMIT_ID%"
</code></pre>




<p>Kudu defines several useful <a href="https://github.com/projectkudu/kudu/wiki/Deployment-Environment">environment variables</a> that you have access to, including the current commit ID.
I&rsquo;m just echoing it out so I can debug when viewing the log output.</p>




<pre><code>call git show -s "%SCM_COMMIT_ID%" --pretty=%%%%s &gt; commitmessage.txt
SET /p COMMIT_MESSAGE=&lt;commitmessage.txt
</code></pre>




<p>Alright. This took me some real trial and error. Git lets you <a href="https://git-scm.com/docs/git-show"><code>show</code> any commit message</a> and can format it using a printf format string (<code>--pretty=%s</code>).
However, due to the weird escaping rules of batch files and variables, this requires not one but <strong>four</strong> <code>%</code> signs. Go figure.</p>




<p>Next I pipe it to a file, this is only so I can read the file back and store the message in a batch variable (<code>COMMIT_MESSAGE</code>), on the next line.
<strong>Kudu team:</strong> It would be sweet to add a <code>SCM_COMMIT_MESSAGE</code> environment variable!</p>




<pre><code>IF NOT "x%COMMIT_MESSAGE:[notest]=%"=="x%COMMIT_MESSAGE%" (
   SET RUN_TESTS=0
)
</code></pre>




<p>Okay, what&rsquo;s going on here? I&rsquo;ll <a href="http://stackoverflow.com/questions/7005951/batch-file-find-if-substring-is-in-string-not-in-a-file">let StackOverflow explain</a>. The <code>:[notest]=</code> portion REPLACES the term &ldquo;[notest]&rdquo; in
the preceding variable (<code>COMMIT_MESSAGE</code>) with an empty string. The <code>x</code> prefix character guards against batch file weirdness.
So if <code>[notest]</code> is NOT present, this will return true (the strings match). If it is present, the condition will be false and so we do <code>IF NOT</code>
since we want to execute when that is the case.</p>




<p>If <code>[notest]</code> is present in the message, we set another variable, <code>RUN_TESTS</code> to 0.</p>




<pre><code>IF /I "%RUN_TESTS%" NEQ "0" (
    echo Running unit tests
    call :ExecuteCmd "%DEPLOYMENT_SOURCE%\tools\nunit\nunit-console.exe" "%DEPLOYMENT_SOURCE%\src\Tests\bin\Release\Tests.dll" /framework:v4.5.1
    IF !ERRORLEVEL! NEQ 0 goto error
) ELSE (
    echo Not running unit tests because [notest] was present in commit message
)
</code></pre>




<p>If <code>RUN_TESTS</code> does not evaluate to 0, then we run the tests! Otherwise we echo out an informative message as to why it was skipped.</p>




<p>Phew. So how much time do we save on <code>[notest]</code> builds now?</p>




<p><img src="https://cloud.githubusercontent.com/assets/563819/11734864/9a5e5e10-9f80-11e5-92ff-b93a1d9c994a.png" alt="No test build" /></p>




<p>Compared to a build with tests:</p>




<p><img src="https://cloud.githubusercontent.com/assets/563819/11734880/b874bed0-9f80-11e5-9af2-8e0425a02563.png" alt="Build with tests" /></p>




<p>So that flag cuts the build in half! Nice! There are probably some other ways to improve the time. By the way, if you&rsquo;re wondering what&rsquo;s taking so long
in your build, you can use the Kudu <a href="https://github.com/projectkudu/kudu/wiki/REST-API">REST endpoint</a> to see your deployment logs (<strong>/api/deployments</strong> endoint) which contain full timestamp information!</p>




<p>Happy continuous deployment!</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2015-12-11T01:30:00+00:00" pubdate data-updated="true">Dec 11<span>th</span>, 2015</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/continuous-deployment/'>Continuous Deployment</a>, <a class='category' href='/blog/categories/continuous-integration/'>Continuous Integration</a>, <a class='category' href='/blog/categories/git/'>Git</a>, <a class='category' href='/blog/categories/kudu/'>Kudu</a>, <a class='category' href='/blog/categories/testing/'>Testing</a>, <a class='category' href='/blog/categories/windows-azure/'>Windows Azure</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2015/11/06/impersonating-during-testing/">Impersonating a User During Automated Testing Scenarios</a></h2>
  
  <p>
    <p>I&rsquo;m starting to introduce privacy controls to <a href="http://keeptrackofmygames.com">Keep Track of My Games</a> and I ran into the following scenario when writing my tests:</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Scenario: Anonymous user should be able to view a public custom list
</span><span class='line'>  Given a user has a list
</span><span class='line'>  And a user&rsquo;s list is public
</span><span class='line'>  When I request access to the list
</span><span class='line'>  Then I have read-only access</span></code></pre></td></tr></table></div></figure></p>

<p>In this context, <strong>I</strong> am the anonymous user. This is the exact <a href="http://www.specflow.org/">SpecFlow</a> scenario I wrote. Do you know why I may have run into issues?</p>




<p>Let&rsquo;s look at the first two steps:</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="na">[Given(@&quot;a user has a list&quot;)]</span>
</span><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAUserHasAList</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="n"><em>listResult</span> <span class="p">=</span> <span class="n"></em>context</span><span class="p">.</span><span class="n">ListService</span><span class="p">.</span><span class="n">CreateList</span><span class="p">(</span><span class="n"><em>newList</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="na">[Given(@&quot;a user&#39;s list is public&quot;)]</span>
</span><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAUsersListIsPublic</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="n"></em>privacySettings</span><span class="p">.</span><span class="n">Level</span> <span class="p">=</span> <span class="n">PrivacyLevel</span><span class="p">.</span><span class="n">Public</span><span class="p">;</span>
</span><span class='line'>  <span class="n"><em>context</span><span class="p">.</span><span class="n">ListService</span><span class="p">.</span><span class="n">UpdateListPrivacy</span><span class="p">(</span><span class="n"></em>listResult</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">_privacySettings</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Why would this cause a problem with my given scenario?</p>




<ol>
<li>In the first step, I&rsquo;m creating a new list.</li>
<li>In the second step, I&rsquo;m taking the new list I just made from the first step and updating the privacy settings on it.</li>
</ol>




<p>The problem is that my service assumes the context is an authenticated user and will apply changes to the <strong>current user&rsquo;s</strong> list. Well, since I did not call my login helpers before these two steps, I am in an anonymous context so the service calls fail. That&rsquo;s good! But how can I tell my steps to call a service method <em>on behalf</em> of another user without having <em>every</em> step use the current user context?</p>




<p>You might say I should just create a new method that accepts a username and refactor my methods. I <em>could</em> do that but not only is my entire service designed around the current user context, my service layer is essentially the interface of my public API. I would never allow one user to create a list for another user (unless that was a feature). So the same way I wouldn&rsquo;t expose an API method to do something on behalf of someone, I won&rsquo;t add a public method in my service layer to do the same. I could choose to make the method private or internal and grant access to the assembly for testing&mdash;true, I <em>could</em> but that seems like a workaround where I need to expose special functionality just for testing.</p>




<p>The approach I ended up doing was simpler and more elegant and leveraged an existing pattern I was relying on: injecting an <code>IUserContext</code> into my service layer like this:</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="nf">ListService</span><span class="p">(</span><span class="n">IUserContext</span> <span class="n">userContext</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">_userContext</span> <span class="p">=</span> <span class="n">userContext</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>This is using standard dependency injection (Ninject, in my case) to inject a context for the current user. That context gets created and maintained outside this class, so it doesn&rsquo;t care who provided it or where it came from, it just uses it to determine business logic.</p>




<p>So since I&rsquo;m already injecting the current user context and mocking it in my tests, why not simply swap out the context when I need to?</p>




<h2>Creating an impersonation context</h2>




<p>That&rsquo;s what I ended up doing. Here&rsquo;s my implementation of a <code>TestingImpersonationContext</code> (<a href="https://gist.github.com/kamranayub/9654d6581fbcf63cf481">https://gist.github.com/kamranayub/9654d6581fbcf63cf481</a>):</p>




<script src="https://gist.github.com/kamranayub/9654d6581fbcf63cf481.js"></script>




<p>It should be clear what&rsquo;s happening but let me explain further. Specifically in SpecFlow you can inject a context into your testing steps like so:</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">StepBase</span> <span class="p">:</span> <span class="n">TechTalk</span><span class="p">.</span><span class="n">SpecFlow</span><span class="p">.</span><span class="n">Steps</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">protected</span> <span class="n">TestingContext</span> <span class="n"><em>context</span><span class="p">;</span>
</span><span class='line'>    <span class="k">public</span> <span class="nf">StepBase</span><span class="p">(</span><span class="n">TestingContext</span> <span class="n">context</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n"></em>context</span> <span class="p">=</span> <span class="n">context</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>As long as your step classes inherit that <code>StepBase</code>, you have access to a context. All I did was build a method off that context that swapped out my existing dependency that was injected for <code>IUserContext</code> with a temporary context that impersonated the requested user. Once it is disposed, it restores the original context. Easy as pie!</p>




<p>If you are <strong>not</strong> using SpecFlow which is probably the case, don&rsquo;t fret&mdash;all you really need is a class or helper method that you can access in your test classes. However you want to achieve that is up to you. Create a base class, don&rsquo;t even bother with dependency injection, etc. This is entirely doable without DI but since my app relies on it I also leverage it during testing.</p>




<p>Now given we have an impersonation context helper, here&rsquo;s how our two testing steps have changed:</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="na">[Given(@&quot;a user has a list&quot;)]</span>
</span><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAUserHasAList</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">using</span> <span class="p">(</span><span class="n"><em>context</span><span class="p">.</span><span class="n">Impersonate</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="n"></em>listResult</span> <span class="p">=</span> <span class="n"><em>context</span><span class="p">.</span><span class="n">ListService</span><span class="p">.</span><span class="n">CreateList</span><span class="p">(</span><span class="n"></em>newList</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="na">[Given(@&quot;a user&#39;s list is public&quot;)]</span>
</span><span class='line'><span class="k">public</span> <span class="k">void</span> <span class="nf">GivenAUsersListIsPublic</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">using</span> <span class="p">(</span><span class="n"><em>context</span><span class="p">.</span><span class="n">Impersonate</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">))</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>        <span class="n"></em>privacySettings</span><span class="p">.</span><span class="n">Level</span> <span class="p">=</span> <span class="n">PrivacyLevel</span><span class="p">.</span><span class="n">Public</span><span class="p">;</span>
</span><span class='line'>        <span class="n"><em>context</span><span class="p">.</span><span class="n">ListService</span><span class="p">.</span><span class="n">UpdateListPrivacy</span><span class="p">(</span><span class="n"></em>listResult</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span> <span class="n">_privacySettings</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>I could even update my scenario to be specific about <strong>who&rsquo;s list</strong> I&rsquo;m accessing (so it&rsquo;s not ambiguous between logged in user vs. another user) but since I only have two users in my testing context, it doesn&rsquo;t really matter.</p>




<p>Now for the test results:</p>


<p><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='c#'><span class='line'><span class="n">Given</span> <span class="n">a</span> <span class="n">user</span> <span class="n">has</span> <span class="n">a</span> <span class="n">list</span>
</span><span class='line'><span class="p">&ndash;&gt;</span> <span class="n">done</span><span class="p">:</span> <span class="n">ListSteps</span><span class="p">.</span><span class="n">GivenAUserHasAList</span><span class="p">()</span> <span class="p">(</span><span class="m">0.2</span><span class="n">s</span><span class="p">)</span>
</span><span class='line'><span class="n">And</span> <span class="n">a</span> <span class="n">user</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">list</span> <span class="k">is</span> <span class="k">public</span>
</span><span class='line'><span class="p">&ndash;&gt;</span> <span class="n">done</span><span class="p">:</span> <span class="n">ListSteps</span><span class="p">.</span><span class="n">GivenAUsersListIsPublic</span><span class="p">()</span> <span class="p">(</span><span class="m">0.0</span><span class="n">s</span><span class="p">)</span>
</span><span class='line'><span class="n">When</span> <span class="n">I</span> <span class="n">request</span> <span class="n">access</span> <span class="n">to</span> <span class="n">the</span> <span class="n">list</span>
</span><span class='line'><span class="p">&ndash;&gt;</span> <span class="n">done</span><span class="p">:</span> <span class="n">ListSteps</span><span class="p">.</span><span class="n">WhenIRequestAccessToTheList</span><span class="p">()</span> <span class="p">(</span><span class="m">0.1</span><span class="n">s</span><span class="p">)</span>
</span><span class='line'><span class="n">Then</span> <span class="n">I</span> <span class="n">have</span> <span class="n">read</span><span class="p">&ndash;</span><span class="n">only</span> <span class="n">access</span>
</span><span class='line'><span class="p">&ndash;&gt;</span> <span class="n">done</span><span class="p">:</span> <span class="n">ListSteps</span><span class="p">.</span><span class="n">ThenIHaveReadAccess</span><span class="p">()</span> <span class="p">(</span><span class="m">0.0</span><span class="n">s</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The tests are green and now I&rsquo;m a happy coder. By the way, if you aren&rsquo;t using <a href="http://specflow.org">SpecFlow</a> for .NET you should consider it, I love it.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2015-11-06T16:00:00+00:00" pubdate data-updated="true">Nov 6<span>th</span>, 2015</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/dot-net/'>.NET</a>, <a class='category' href='/blog/categories/c-number/'>C#</a>, <a class='category' href='/blog/categories/keep-track-of-my-games/'>Keep Track of My Games</a>, <a class='category' href='/blog/categories/specflow/'>SpecFlow</a>, <a class='category' href='/blog/categories/testing/'>Testing</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2015/10/10/azure-cdn-cassette/">Using Azure CDN Origin Pull With Cassette</a></h2>
  
  <p>
    <p>For the October update for <a href="http://keeptrackofmygames.com">Keep Track of My Games</a> I wanted to offload my web assets to a CDN. Since I&rsquo;m already using <a href="http://azure.com">Microsoft Azure</a> to host the site, I decided to use <a href="https://azure.microsoft.com/en-us/services/cdn/">Azure CDN</a>.</p>




<p>I set it up for &ldquo;Origin Pull&rdquo; which means that instead of uploading my assets to the CDN (Azure Blob storage), you request a file from the CDN and Azure will go and get it from your website and then cache it on their servers.</p>




<p>So as an example:</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>User requests <a href="http://az888888.vo.msecnd.net/stylesheets/foo.png">http://az888888.vo.msecnd.net/stylesheets/foo.png</a>
</span><span class='line'>|
</span><span class='line'>|
</span><span class='line'>CDN: have I cached &ldquo;stylesheets/foo.png?&rdquo;
</span><span class='line'>  Yes: Serve content from edge cache (closest to user)
</span><span class='line'>  No: Request <a href="http://yourwebsites.com/stylesheets/foo.png">http://yourwebsites.com/stylesheets/foo.png</a> and serve</span></code></pre></td></tr></table></div></figure></p>

<p>You can read more about <a href="https://azure.microsoft.com/en-us/documentation/articles/cdn-create-new-endpoint/">how to set up origin pull in Azure CDN</a>. In my case, I used &ldquo;Custom Origin&rdquo; of &ldquo;<a href="http://keeptrackofmygames.com">http://keeptrackofmygames.com</a>&rdquo;.</p>




<h2>Using CDN with Cassette</h2>




<p>I use the .NET library <a href="http://getcassette.com">Cassette</a> for bundling &amp; minification for KTOMG&mdash;when I started KTOMG there was no Microsoft provided option and Cassette has been really stable.</p>




<p>It works pretty much as you&rsquo;d expect:</p>




<ul>
<li>Define &ldquo;bundles&rdquo; which are sets of scripts/stylesheets</li>
<li>Render bundles onto page(s)</li>
<li>If debug mode, render individually otherwise minify and concatenate</li>
</ul>




<p>By default, Cassette will render URLs like this in your source code:</p>




<p>In debug mode:</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Bundle: ~/Content/core
</span><span class='line'>
</span><span class='line'>&ndash; /cassette.axd/asset/Content/bootstrap.css?hash
</span><span class='line'>&ndash; /cassette.axd/asset/Content/site.css?hash
</span><span class='line'>&ndash; /cassette.axd/asset/Content/app.css?hash</span></code></pre></td></tr></table></div></figure></p>

<p>And in production:</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/cassette.axd/stylesheet/{hash}/Content/core</span></code></pre></td></tr></table></div></figure></p>

<p>But if we want to serve assets over the CDN, we need to plug in our special CDN URL prefix&mdash;not only for script/stylesheet references but also references to images <em>in</em> those files.</p>




<p>Luckily, Cassette provides a facility to modify generated URLs by letting you register a <code>IUrlGenerator</code>. Here&rsquo;s my full implementation of this for my CDN:</p>




<script src="https://gist.github.com/kamranayub/2da4ccfec3e7812c8367.js"></script>




<p>As you can see, I register a custom <code>IUrlGenerator</code> and a custom <code>IUrlModifier</code>. The default <code>IUrlModifider</code> is Cassette&rsquo;s <code>VirtualDirectoryPrepender</code> and it just prepends &ldquo;/&rdquo; to the beginning of every URL but in our case we want to conditionally prepend the Azure CDN endpoint in production.</p>




<p>In production, this will produce the following output:</p>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'><a href="https://az99999.vo.msecnd.net/cassette.axd/stylesheet/">https://az99999.vo.msecnd.net/cassette.axd/stylesheet/</a>{hash}/Content/core</span></code></pre></td></tr></table></div></figure></p>

<p>To allow local debugging and CDN in production I just use an app setting in the web.config. In Azure, I also add an application setting (<code>CdnUrl</code>) through the portal in my production slot with the correct CDN URL and voila&mdash;all my assets will now be served over CDN.</p>




<h3>Notes</h3>




<ul>
<li><p>Azure CDN does not yet support HTTPS for custom origin domains. So if you want to serve content over <a href="http://static.yoursite.com">http://static.yoursite.com</a> you can&rsquo;t serve it over HTTPS because Azure doesn&rsquo;t allow you to upload or set a SSL certificate to use and insteads uses their own certificate which is not valid for your domain. <a href="http://feedback.azure.com/forums/169397-cdn/suggestions/1332683-allow-https-for-custom-cdn-domain-names">Vote up the UserVoice issue</a> on this.</p></li>
<li><p>Azure CDN origin pull does not seem to respect <code>Cache-Control: private</code> HTTP header. For example, by default MVC serves pages with private cache control which means browsers won&rsquo;t cache that page and neither <em>should</em> Azure CDN&mdash;but it does anyway. In my case, I really don&rsquo;t want a true mirror of my site, I just wants assets served over CDN and Cassette sets <code>Cache-Control: public</code> on them automatically. <a href="http://feedback.azure.com/forums/169397-cdn/suggestions/10148280-respect-cache-control-private-for-origin-pull">You can upvote my feature request on UserVoice</a>.</p></li>
<li><p>I am choosing <strong>not</strong> to point my entire domain to the CDN. Some folks choose to serve their entire site over the CDN which is definitely something you can do. However, in my case, I didn&rsquo;t want to do that. If you instead chose to point your domain to the CDN endpoint, you don&rsquo;t need to do any of this&mdash;<strong>everything</strong> will be served over the CDN.</p></li>
</ul>




  </p>
  <span class="meta">
    written 








  



<time datetime="2015-10-10T00:30:00+00:00" pubdate data-updated="true">Oct 10<span>th</span>, 2015</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/dot-net/'>.NET</a>, <a class='category' href='/blog/categories/azure/'>Azure</a>, <a class='category' href='/blog/categories/c-number/'>C#</a>, <a class='category' href='/blog/categories/keep-track-of-my-games/'>Keep Track of My Games</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2015/09/17/powershell-html5-offline-manifest/">PowerShell Script to Generate an HTML5 Offline Manifest</a></h2>
  
  <p>
    <p>In my new role at work I&rsquo;ve been learning PowerShell to administrate our systems (I&rsquo;m a half developer, half sys admin monster). I&rsquo;ve been a developer for a long time and been living in .NET for about as long&mdash;I still had not really <em>embraced</em> PowerShell as something I could use in my daily development routine. I&rsquo;ve changed my tune. <strong>PowerShell is awesome.</strong> It&rsquo;s also not too hard to pick up once you learn how it works. I recommend you take a serious look at learning it. I recommend <a href="https://www.microsoftvirtualacademy.com/en-us/training-courses/getting-started-with-powershell-3-0-jump-start-8276">following the PowerShell 3 Jumpstart course</a> and trial and error.</p>




<p>Anyway, for some of the games we write as part of <a href="http://excaliburjs.com">Excalibur.js</a> for game jams we would like to run them offline. To do this, you need to create an <a href="http://www.html5rocks.com/en/tutorials/appcache/beginner/">HTML5 Application Manifest file</a>. However, this file is super finicky, as outlined in the linked article. In order to assist, I wrote a small PowerShell script that generates an <code>appcache</code> manifest file with each file&rsquo;s MD5 checksum. Therefore, the manifest file will only change when dependent assets change. I do some more work to disable it locally and only enable for release, but you can run this script as part of your build.</p>




<script src="https://gist.github.com/kamranayub/cc2c4d371a83aec8279e.js"></script>




<p>Modify the script to be specific to your project and it should output an appropriate manifest file. Feel free to change as you see fit.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2015-09-17T02:40:00+00:00" pubdate data-updated="true">Sep 17<span>th</span>, 2015</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/html5/'>HTML5</a>, <a class='category' href='/blog/categories/powershell/'>PowerShell</a>, <a class='category' href='/blog/categories/tips-and-tricks/'>Tips & Tricks</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2015/07/29/gmail-special-address/">Use Special Gmail Addresses to Redirect and Filter Incoming Mail or Bypass Unique Email Checks</a></h2>
  
  <p>
    <p>If you have a Gmail account, there&rsquo;s a sweet feature you might not know about.</p>




<p>Let&rsquo;s say your email is:</p>




<p><code>johndoe@gmail.com</code></p>




<p>First tip: adding dots (.) does not change the email. The following emails are identical to Google and will route email to <code>johndoe@gmail.com</code>:</p>




<ul>
<li><code>john.doe@gmail.com</code></li>
<li><code>john....doe@gmail.com</code></li>
<li>etc.</li>
</ul>




<p>Next tip: you can add a plus sign to the end of your email and then type in whatever you want. It&rsquo;ll <em>still</em> get sent to you. You can use this to your advantage by filtering mail sent to that specific tagged address or you can bypass &ldquo;unique email&rdquo; checks on websites but still get email sent to you:</p>




<ul>
<li><code>johndoe+medium.com@gmail.com</code></li>
<li><code>johndoe+microsoft.com@gmail.com</code></li>
<li><code>johndoe+spam@gmail.com</code></li>
</ul>




<p>So you could filter incoming mail based on those addresses above. This comes in really handy for sites you don&rsquo;t care about but still need at least one email from them&mdash;the rest can be filtered. It can also be useful to identify spam email sources&mdash;who leaked your email? If you saw spam addressed to <code>johndoe+spamsite@gmail.com</code>, you know <code>spamsite</code> was responsible for leaking/sharing your email.</p>




<p>Happy power-Gmailing!</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2015-07-29T04:23:00+00:00" pubdate data-updated="true">Jul 29<span>th</span>, 2015</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/gmail/'>Gmail</a>, <a class='category' href='/blog/categories/tips-and-tricks/'>Tips & Tricks</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2015/07/29/install-windows-10-immediately/">[Updated] Install Windows 10 Immediately Before Rollout</a></h2>
  
  <p>
    <p><strong>Update (8:49pm)</strong>: I adjusted my Windows 8 date/time to tomorrow and the progress of the update jumped and I&rsquo;m completed now. I now see a Restart PC to finish installing updates.</p>




<p><strong>Update (9:00pm)</strong>: Well it looks like it&rsquo;s a bust with Windows 8.1. My friend tested on Windows 7 and it worked but mine refuses to install&mdash;it just says I have it reserved and it&rsquo;s ready. I tried rebooting multiple times and running the /updatenow command again but no go.</p>




<p><img src="https://cloud.githubusercontent.com/assets/563819/8948430/c0f67f0e-356c-11e5-9daf-8cafb3521042.png" alt="image" /></p>




<p><strong>Update (10:00pm CST):</strong> No luck on my other PC, same situation. Guess I&rsquo;ll just have to wait in line like everybody else!</p>




<hr />




<p>This is only applicable for the next few hours until your machine gets Windows 10 rolled out. If you&rsquo;re impatient like me, a friend tipped me off that he was able to install Windows 10 prematurely by simply forcing Windows Update to download Windows 10 and then setting his system time forward a day (BIOS, I&rsquo;m thinking).</p>




<p>It&rsquo;s kind of unbelievable but it&rsquo;s working so far. I&rsquo;m at 95% complete downloading (you can view in Windows Update window).</p>




<p><img src="https://cloud.githubusercontent.com/assets/563819/8948016/ce3997f0-3567-11e5-8e1e-679fd5b54daa.png" alt="Progress" /></p>




<ol>
<li>Hit Windows+R to bring up Run command</li>
<li>Type in <code>wuauclt.exe /updatenow</code> (<strong>Works</strong>)</li>
<li>Wait for the download to finish (Control Panel &ndash;> Windows Update) (<strong>Works</strong>)</li>
<li>When Windows Update says, &ldquo;Preparing for installation&hellip;&rdquo;, set system time forward a day in Windows (<strong>Works</strong>)<br/>
<img src="https://cloud.githubusercontent.com/assets/563819/8948191/fa639e0a-3569-11e5-97c0-2b79d709c8cf.png" alt="image" /></li>
<li>When progress is done, reboot (<strong>Untested</strong>)</li>
<li>Windows 10 should install (<strong>Untested</strong>)</li>
</ol>




<p>I will update this post with any new information.</p>


  </p>
  <span class="meta">
    written 








  



<time datetime="2015-07-29T02:13:00+00:00" pubdate data-updated="true">Jul 29<span>th</span>, 2015</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/windows-10/'>Windows 10</a>
  
</span>


  </span>

  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2015/05/30/ktomg-update/">Behind the Major Update to Keep Track of My Games</a></h2>
  
  <p>
    <p><img src="https://cloud.githubusercontent.com/assets/563819/7899619/b3154994-072a-11e5-8da1-b9a9703a8b57.png" alt="My profile" /></p>




<p>Today I just pushed a <strong>major</strong> update to <a href="http://keeptrackofmygames.com">KTOMG</a>. <em>Psst, you should join!</em></p>




<p>You can <a href="http://blog.keeptrackofmygames.com/post/120264549011/updates-for-may-2015">reference the blog post</a> for details on features but on the technical side I&rsquo;m pretty proud because I got to implement a bunch of new tech that I&rsquo;ve been wanting to learn properly.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2015-05-30T22:13:00+00:00" pubdate data-updated="true">May 30<span>th</span>, 2015</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/css3/'>CSS3</a>, <a class='category' href='/blog/categories/front-end/'>Front-End</a>, <a class='category' href='/blog/categories/html5/'>HTML5</a>, <a class='category' href='/blog/categories/javascript/'>Javascript</a>, <a class='category' href='/blog/categories/keep-track-of-my-games/'>Keep Track of My Games</a>, <a class='category' href='/blog/categories/projects/'>Projects</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2015/05/30/ktomg-update/">Read on &rarr;</a>
  
</article>

            </div>
          </div>
        
          
          <div class="row">
            <div class="col-md-offset-2 col-md-8">
              <article>
  <h2><a href="/blog/2015/05/25/knockout-binding-report/">Knockout.js Binding Report for Performance Tuning</a></h2>
  
  <p>
    <p>I use a lot of <a href="http://knockoutjs.com">Knockout.js</a> on <a href="http://keeptrackofmygames.com">Keep Track of My Games</a>. I love Knockout but sometimes it makes it difficult to understand what&rsquo;s slowing my page down.</p>




  </p>
  <span class="meta">
    written 








  



<time datetime="2015-05-25T10:30:00+00:00" pubdate data-updated="true">May 25<span>th</span>, 2015</time>
    

in
<span class="categories">
  
    <a class='category' href='/blog/categories/chrome/'>Chrome</a>, <a class='category' href='/blog/categories/gists/'>Gists</a>, <a class='category' href='/blog/categories/javascript/'>Javascript</a>, <a class='category' href='/blog/categories/keep-track-of-my-games/'>Keep Track of My Games</a>, <a class='category' href='/blog/categories/knockout/'>Knockout</a>, <a class='category' href='/blog/categories/oss/'>OSS</a>, <a class='category' href='/blog/categories/performance/'>Performance</a>
  
</span>


  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2015/05/25/knockout-binding-report/">Read on &rarr;</a>
  
</article>

            </div>
          </div>
        
      </div>
    </div>

    <hr class="divider-short"/>

    <div class="archive-link">
      <h3><a href="/blog/archives/">All Posts</a></h3>
    </div>
  </div>
</div>

    <footer id="footer" class="her-row">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
  <a href="/"><h4>Home</h4></a>
</div>

<div class="col-md-2">
  <div class="social-icon-list">
    
    <a href="https://twitter.com/kamranayub"><img src="/images/glyphicons_social_31_twitter.png"/></a>
    

    
    <a href="https://github.com/kamranayub"><img src="/images/glyphicons_social_21_github.png"/></a>
    

    

    
  </div>
</div>

<div class="pull-right">
  <h4>Powered by <a href="http://octopress.org/">Octopress</a>. Designed by <a href="http://AdrianArtiles.com">Adrian Artiles</a>.</h4>
</div>


    </div>
  </div>
</footer>

    
  </body>
</html>
